#!/usr/bin/python3
# -*- encoding: utf-8 -*-
from datetime import datetime
from scrips import authz_003
from scrips import config_007
from scrips import config_008
from scrips import ident_004
from scrips import info_003
from scrips import info_004
from scrips import info_007
import time


class Pentest():
    
    def __init__(self, id=0, url=None, dominio=None, ip=None, pruebas=None):
        self.id = id
        self.url= url
        self.dominio = dominio
        self.ip = ip
        self.pruebas = pruebas
        self.fecha_Ini = None
        self.fecha_Fin = None
    
    def fecha(self):
        fecha = datetime.now()
        return  fecha.strftime('Día :%d, Mes: %m, Año: %Y, Hora: %H, Minutos: %M, Segundos: %S')
    
    def ejecutar(self):
        if 'info_003' in self.pruebas:
            objPrueba = info_003.Info_003(self.url)
            resultado, recomendaciones = objPrueba.main()


        if 'info_004' in self.pruebas:
            objPrueba = info_004.Info_004(self.dominio)
            resultado, recomendaciones = objPrueba.main()


        if 'info_007' in self.pruebas:
            objPrueba = info_007.Info_007(self.url)
            resultado, recomendaciones = objPrueba.main()
            

        if 'config_007' in self.pruebas:
            objPrueba = config_007.Config_007(self.url)
            resultado, recomendaciones = objPrueba.main()
            print(resultado)
            print(recomendaciones) 
        
        
        if 'config_008' in self.pruebas:
            objPrueba = config_008.Config_008(self.url)
            resultado, recomendaciones = objPrueba.main()
            print(resultado)
            print(recomendaciones)            


        if 'ident_004' in self.pruebas:
            objPrueba = ident_004.Ident_004(self.dominio)
            resultado, recomendaciones = objPrueba.main()




        if 'authz_003' in self.pruebas:
            objPrueba = authz_003.Authz_003(self.dominio)
            resultado, recomendaciones = objPrueba.main()
            #print(resultado)
            #print(recomendaciones)
            



        
    
        