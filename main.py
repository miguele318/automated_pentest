#!/usr/bin/python3
# -*- encoding: utf-8 -*-

from reporte import reporte
from scrips import *
import pentest
import argparse



if __name__ == '__main__':

    parser = argparse.ArgumentParser()
    parser.add_argument("--id_pentest", help="Usuario de prueba. Ej: usuario1,password1",type=int)
    parser.add_argument("--url", help="URL del sitio. Ej: http://www.example.com",type=str)
    parser.add_argument("--dominio", help="Dominio del sitio. Ej: example.com",type=str)
    parser.add_argument("--ip", help="Ip del sitio. Ej: 10.10.10.10, 192.168.0.10",type=str)
    parser.add_argument("--pruebas", help="Identificadores de las pruebas sin otg separadas por ','. Ej. authz_007,info_003",type=str)


    args = parser.parse_args()
    id_pentest = args.id_pentest
    url = args.url
    dominio = args.dominio
    ip = args.ip
    pruebas = args.pruebas.split(',')

    datos = []
    info = {"ID":"OTG-AUTHZ-003",
        "NOMBRE": "Prueba para escalación de privilegios",
        "TOPTEN": "A6:2017",
        "CATEGORIA": "Configuración de Seguridad Incorrecta",
        "HERRAMIENTAS": "Sqlmap, brutespray.py",
        "RESULTADOS": "jadbajkdbvhjadmxnjv na;lcnbvkanlc.xm <br /> andnkj<br /> vkadvnbhskjcnv al;vnb adjcnvb jqjcnbv jkadmvebw nlkdjvebjn dwejvbwnmqdlvne bjadvenbij vnlwdnveb jwkqldfvbwjklfjnvebjs mwejvbnwlk vbwjkl fnjwkl vbeh bcnw cn jwkdmvjew nmwkevjn lwknek fmek",
        "RECOMENDACIONES":"RECOMENDACIONES"}
    
    for i in range(25):
        datos.append(info)

    pentest = pentest.Pentest(id_pentest, url, dominio, ip, pruebas)
    #pentest.ejecutar()
    reporte.generarReporte(pentest.id, datos)
   

