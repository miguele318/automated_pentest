#!/usr/bin/python3
# -*- encoding: utf-8 -*-

from reporte import reporte
from scrips import *
import pentest
import argparse



if __name__ == '__main__':

    parser = argparse.ArgumentParser()
    parser.add_argument("--id_pentest", help="Usuario de prueba. Ej: usuario1,password1",type=int)
    parser.add_argument("--url", help="URL del sitio. Ej: http://www.example.com",type=str)
    parser.add_argument("--dominio", help="Dominio del sitio. Ej: example.com",type=str)
    #parser.add_argument("--ip", help="Ip del sitio. Ej: 10.10.10.10, 192.168.0.10",type=str)
    parser.add_argument("--pruebas", help="Identificadores de las pruebas sin otg separadas por ','. Ej. authz_007,info_003",type=str)


    args = parser.parse_args()
    id_pentest = args.id_pentest
    url = args.url
    dominio = args.dominio
    #ip = args.ip
    pruebas = args.pruebas.split(',')

    

    pentest = pentest.Pentest(id_pentest, url, dominio, pruebas)
    pentest.ejecutar()
    reporte.generarReporte(pentest.id, pentest.pruebas)